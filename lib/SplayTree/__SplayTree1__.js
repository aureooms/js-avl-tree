"use strict";

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.default = __SplayTree1__;
function __SplayTree1__(diff) {

	var zig, zag, zigzig, zigzag, zagzig, zagzag, z, zz;
	var _insert, splay, remove, _in_order_traversal, splay_tree;

	zig = function zig(x, y) {
		y[0] = x[1];x[1] = y;
	};
	zag = function zag(x, y) {
		y[1] = x[0];x[0] = y;
	};

	zigzig = function zigzig(x, p, g) {
		zig(p, g);zig(x, p);
	};
	zigzag = function zigzag(x, p, g) {
		zig(x, g);zag(x, p);
	};
	zagzig = function zagzig(x, p, g) {
		zag(x, g);zig(x, p);
	};
	zagzag = function zagzag(x, p, g) {
		zag(p, g);zag(x, p);
	};

	z = [zig, zag];
	zz = [[zigzig, zigzag], [zagzig, zagzag]];

	_insert = function insert(pt, v) {

		var w;

		w = diff(v, pt[2]) > 0 | 0;

		if (pt[w] === null) {
			pt[w] = [null, null, v];
		} else {
			_insert(pt[w], v);
		}
	};

	splay = function splay(el, v) {

		var turn, path, pt, f, d, w, i;

		turn = [];
		path = [];
		pt = el;
		f = undefined;

		while (f === undefined) {

			if (pt === null) {
				f = false;
				pt = path[path.length - 1];
				--turn.length;
			} else {

				d = diff(v, pt[2]);

				if (d === 0) {
					f = true;
				} else {
					w = d > 0 | 0;
					path.push(pt);
					turn.push(w);
					pt = pt[w];
				}
			}
		}

		i = turn.length - 1;

		for (; i > 0; i -= 2) {
			zz[turn[i - 1]][turn[i]](pt, path[i], path[i - 1]);
		}

		if (i === 0) {
			z[turn[0]](pt, el);
		}

		return [f, pt];
	};

	remove = function remove(el, v) {
		var r;

		r = splay(el, v);

		if (!r[0]) {
			return r[1];
		}

		if (r[1][0] === null) {
			return r[1][1];
		} else if (r[1][1] === null) {
			return r[1][0];
		} else {
			r[1][0] = splay(r[1][0], v)[1];
			r[1][0][1] = r[1][1];
			return r[1][0];
		}
	};

	_in_order_traversal = function in_order_traversal(pt, callback) {

		if (pt[0] !== null) {
			_in_order_traversal(pt[0], callback);
		}

		callback(pt[2]);

		if (pt[1] !== null) {
			_in_order_traversal(pt[1], callback);
		}
	};

	splay_tree = function splay_tree() {
		this.pt = null;
	};

	splay_tree.prototype.insert = function (v) {

		if (this.pt === null) {
			this.pt = [null, null, v];
		} else {
			_insert(this.pt, v);
		}
	};

	splay_tree.prototype.find = function (v) {

		var r;

		if (this.pt === null) {
			return [false, null];
		}

		r = splay(this.pt, v);
		this.pt = r[1];

		return [r[0], r[1][2]];
	};

	splay_tree.prototype.remove = function (v) {
		if (this.pt !== null) {
			this.pt = remove(this.pt, v);
		}
	};

	splay_tree.prototype.in_order_traversal = function (fn) {
		if (this.pt !== null) {
			_in_order_traversal(this.pt, fn);
		}
	};

	return splay_tree;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9TcGxheVRyZWUvX19TcGxheVRyZWUxX18uanMiXSwibmFtZXMiOlsiX19TcGxheVRyZWUxX18iLCJkaWZmIiwiemlnIiwiemFnIiwiemlnemlnIiwiemlnemFnIiwiemFnemlnIiwiemFnemFnIiwieiIsInp6IiwiaW5zZXJ0Iiwic3BsYXkiLCJyZW1vdmUiLCJpbl9vcmRlcl90cmF2ZXJzYWwiLCJzcGxheV90cmVlIiwieCIsInkiLCJwIiwiZyIsInB0IiwidiIsInciLCJlbCIsInR1cm4iLCJwYXRoIiwiZiIsImQiLCJpIiwidW5kZWZpbmVkIiwibGVuZ3RoIiwicHVzaCIsInIiLCJjYWxsYmFjayIsInByb3RvdHlwZSIsImZpbmQiLCJmbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7a0JBQ3dCQSxjO0FBQVQsU0FBU0EsY0FBVCxDQUEwQkMsSUFBMUIsRUFBaUM7O0FBRS9DLEtBQUlDLEdBQUosRUFBU0MsR0FBVCxFQUFjQyxNQUFkLEVBQXNCQyxNQUF0QixFQUE4QkMsTUFBOUIsRUFBc0NDLE1BQXRDLEVBQThDQyxDQUE5QyxFQUFpREMsRUFBakQ7QUFDQSxLQUFJQyxPQUFKLEVBQVlDLEtBQVosRUFBbUJDLE1BQW5CLEVBQTJCQyxtQkFBM0IsRUFBK0NDLFVBQS9DOztBQUVBWixPQUFNLGFBQVdhLENBQVgsRUFBY0MsQ0FBZCxFQUFrQjtBQUFFQSxJQUFFLENBQUYsSUFBT0QsRUFBRSxDQUFGLENBQVAsQ0FBYUEsRUFBRSxDQUFGLElBQU9DLENBQVA7QUFBVyxFQUFsRDtBQUNBYixPQUFNLGFBQVdZLENBQVgsRUFBY0MsQ0FBZCxFQUFrQjtBQUFFQSxJQUFFLENBQUYsSUFBT0QsRUFBRSxDQUFGLENBQVAsQ0FBYUEsRUFBRSxDQUFGLElBQU9DLENBQVA7QUFBVyxFQUFsRDs7QUFFQVosVUFBUyxnQkFBV1csQ0FBWCxFQUFjRSxDQUFkLEVBQWlCQyxDQUFqQixFQUFxQjtBQUFFaEIsTUFBS2UsQ0FBTCxFQUFRQyxDQUFSLEVBQWFoQixJQUFL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QUU1QyxNQUFLLEtBQUtELEVBQUwsS0FBWSxJQUFqQixFQUF3QjtBQUN2QixRQUFLQSxFQUFMLEdBQVUsQ0FBQyxJQUFELEVBQU8sSUFBUCxFQUFhQyxDQUFiLENBQVY7QUFDQSxHQUZELE1BSUs7QUFDSlYsV0FBUSxLQUFLUyxFQUFiLEVBQWlCQyxDQUFqQjtBQUNBO0FBRUQsRUFWRDs7QUFZQU4sWUFBV21CLFNBQVgsQ0FBcUJDLElBQXJCLEdBQTRCLFVBQVdkLENBQVgsRUFBZTs7QUFFMUMsTUFBSVcsQ0FBSjs7QUFFQSxNQUFLLEtBQUtaLEVBQUwsS0FBWSxJQUFqQixFQUF3QjtBQUN2QixVQUFPLENBQUMsS0FBRCxFQUFRLElBQVIsQ0FBUDtBQUNBOztBQUVEWSxNQUFJcEIsTUFBTyxLQUFLUSxFQUFaLEVBQWdCQyxDQUFoQixDQUFKO0FBQ0EsT0FBS0QsRUFBTCxHQUFVWSxFQUFFLENBQUYsQ0FBVjs7QUFFQSxTQUFPLENBQUNBLEVBQUUsQ0FBRixDQUFELEVBQU9BLEVBQUUsQ0FBRixFQUFLLENBQUwsQ0FBUCxDQUFQO0FBQ0EsRUFaRDs7QUFjQWpCLFlBQVdtQixTQUFYLENBQXFCckIsTUFBckIsR0FBOEIsVUFBV1EsQ0FBWCxFQUFlO0FBQzVDLE1BQUssS0FBS0QsRUFBTCxLQUFZLElBQWpCLEVBQXdCO0FBQ3ZCLFFBQUtBLEVBQUwsR0FBVVAsT0FBUSxLQUFLTyxFQUFiLEVBQWlCQyxDQUFqQixDQUFWO0FBQ0E7QUFDRCxFQUpEOztBQU1BTixZQUFXbUIsU0FBWCxDQUFxQnBCLGtCQUFyQixHQUEwQyxVQUFXc0IsRUFBWCxFQUFnQjtBQUN6RCxNQUFLLEtBQUtoQixFQUFMLEtBQVksSUFBakIsRUFBd0I7QUFDdkJOLHVCQUFvQixLQUFLTSxFQUF6QixFQUE2QmdCLEVBQTdCO0FBQ0E7QUFDRCxFQUpEOztBQU1BLFFBQU9yQixVQUFQO0FBRUEiLCJmaWxlIjoiX19TcGxheVRyZWUxX18uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIF9fU3BsYXlUcmVlMV9fICggZGlmZiApIHtcblxuXHR2YXIgemlnLCB6YWcsIHppZ3ppZywgemlnemFnLCB6YWd6aWcsIHphZ3phZywgeiwgeno7XG5cdHZhciBpbnNlcnQsIHNwbGF5LCByZW1vdmUsIGluX29yZGVyX3RyYXZlcnNhbCwgc3BsYXlfdHJlZTtcblxuXHR6aWcgPSBmdW5jdGlvbiAoIHgsIHkgKSB7IHlbMF0gPSB4WzFdOyB4WzFdID0geTsgfTtcblx0emFnID0gZnVuY3Rpb24gKCB4LCB5ICkgeyB5WzFdID0geFswXTsgeFswXSA9IHk7IH07XG5cblx0emlnemlnID0gZnVuY3Rpb24gKCB4LCBwLCBnICkgeyB6aWcoIHAsIGcgKTsgemlnKCB4LCBwICk7IH07XG5cdHppZ3phZyA9IGZ1bmN0aW9uICggeCwgcCwgZyApIHsgemlnKCB4LCBnICk7IHphZyggeCwgcCApOyB9O1xuXHR6YWd6aWcgPSBmdW5jdGlvbiAoIHgsIHAsIGcgKSB7IHphZyggeCwgZyApOyB6aWcoIHgsIHAgKTsgfTtcblx0emFnemFnID0gZnVuY3Rpb24gKCB4LCBwLCBnICkgeyB6YWcoIHAsIGcgKTsgemFnKCB4LCBwICk7IH07XG5cblx0eiAgPSBbemlnLCB6YWddO1xuXHR6eiA9IFsgW3ppZ3ppZywgemlnemFnXSwgW3phZ3ppZywgemFnemFnXSBdO1xuXG5cdGluc2VydCA9IGZ1bmN0aW9uICggcHQsIHYgKSB7XG5cblx0XHR2YXIgdztcblxuXHRcdHcgPSBkaWZmKCB2LCBwdFsyXSApID4gMCB8IDA7XG5cblx0XHRpZiAoIHB0W3ddID09PSBudWxsICkge1xuXHRcdFx0cHRbd10gPSBbbnVsbCwgbnVsbCwgdl07XG5cdFx0fVxuXG5cdFx0ZWxzZSB7XG5cdFx0XHRpbnNlcnQocHRbd10sIHYpO1xuXHRcdH1cblxuXHR9O1xuXG5cdHNwbGF5ID0gZnVuY3Rpb24gKCBlbCwgdiApIHtcblxuXHRcdHZhciB0dXJuLCBwYXRoLCBwdCwgZiwgZCwgdywgaTtcblxuXHRcdHR1cm4gPSBbXTtcblx0XHRwYXRoID0gW107XG5cdFx0cHQgPSBlbDtcblx0XHRmID0gdW5kZWZpbmVkO1xuXG5cdFx0d2hpbGUgKCBmID09PSB1bmRlZmluZWQgKSB7XG5cblx0XHRcdGlmICggcHQgPT09IG51bGwgKSB7XG5cdFx0XHRcdGYgPSBmYWxzZTtcblx0XHRcdFx0cHQgPSBwYXRoW3BhdGgubGVuZ3RoIC0gMV07XG5cdFx0XHRcdC0tdHVybi5sZW5ndGg7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIHtcblxuXHRcdFx0XHRkID0gZGlmZiggdiwgcHRbMl0gKTtcblxuXHRcdFx0XHRpZiAoIGQgPT09IDAgKSB7XG5cdFx0XHRcdFx0ZiA9IHRydWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHR3ID0gZCA+IDAgfCAwO1xuXHRcdFx0XHRcdHBhdGgucHVzaCggcHQgKTtcblx0XHRcdFx0XHR0dXJuLnB1c2goIHcgKTtcblx0XHRcdFx0XHRwdCA9IHB0W3ddO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHR9XG5cblx0XHRpID0gdHVybi5sZW5ndGggLSAxO1xuXG5cdFx0Zm9yICggOyBpID4gMCA7IGkgLT0gMiApIHtcblx0XHRcdHp6W3R1cm5baS0xXV1bdHVybltpXV0oIHB0LCBwYXRoW2ldLCBwYXRoW2ktMV0gKTtcblx0XHR9XG5cblx0XHRpZiAoIGkgPT09IDAgKSB7XG5cdFx0XHR6W3R1cm5bMF1dKCBwdCwgZWwgKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gW2YsIHB0XTtcblx0fTtcblxuXHRyZW1vdmUgPSBmdW5jdGlvbiAoIGVsLCB2ICkge1xuXHRcdHZhciByO1xuXG5cdFx0ciA9IHNwbGF5KCBlbCwgdiApO1xuXG5cdFx0aWYgKCAhclswXSApIHtcblx0XHRcdHJldHVybiByWzFdO1xuXHRcdH1cblxuXG5cdFx0aWYgKCByWzFdWzBdID09PSBudWxsICkge1xuXHRcdFx0cmV0dXJuIHJbMV1bMV07XG5cdFx0fVxuXG5cdFx0ZWxzZSBpZiAoIHJbMV1bMV0gPT09IG51bGwgKSB7XG5cdFx0XHRyZXR1cm4gclsxXVswXTtcblx0XHR9XG5cblx0XHRlbHNlIHtcblx0XHRcdHJbMV1bMF0gPSBzcGxheSggclsxXVswXSwgdiApWzFdO1xuXHRcdFx0clsxXVswXVsxXSA9IHJbMV1bMV07XG5cdFx0XHRyZXR1cm4gclsxXVswXTtcblx0XHR9XG5cblx0fTtcblxuXHRpbl9vcmRlcl90cmF2ZXJzYWwgPSBmdW5jdGlvbiAoIHB0LCBjYWxsYmFjayApIHtcblxuXHRcdGlmICggcHRbMF0gIT09IG51bGwgKSB7XG5cdFx0XHRpbl9vcmRlcl90cmF2ZXJzYWwoIHB0WzBdLCBjYWxsYmFjayApO1xuXHRcdH1cblxuXHRcdGNhbGxiYWNrKCBwdFsyXSApO1xuXG5cdFx0aWYgKCBwdFsxXSAhPT0gbnVsbCApIHtcblx0XHRcdGluX29yZGVyX3RyYXZlcnNhbCggcHRbMV0sIGNhbGxiYWNrICk7XG5cdFx0fVxuXG5cdH07XG5cblxuXHRzcGxheV90cmVlID0gZnVuY3Rpb24gKCkge1xuXHRcdHRoaXMucHQgPSBudWxsO1xuXHR9O1xuXG5cdHNwbGF5X3RyZWUucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uICggdiApIHtcblxuXHRcdGlmICggdGhpcy5wdCA9PT0gbnVsbCApIHtcblx0XHRcdHRoaXMucHQgPSBbbnVsbCwgbnVsbCwgdl07XG5cdFx0fVxuXG5cdFx0ZWxzZSB7XG5cdFx0XHRpbnNlcnQoIHRoaXMucHQsIHYgKTtcblx0XHR9XG5cblx0fTtcblxuXHRzcGxheV90cmVlLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKCB2ICkge1xuXG5cdFx0dmFyIHI7XG5cblx0XHRpZiAoIHRoaXMucHQgPT09IG51bGwgKSB7XG5cdFx0XHRyZXR1cm4gW2ZhbHNlLCBudWxsXTtcblx0XHR9XG5cblx0XHRyID0gc3BsYXkoIHRoaXMucHQsIHYgKTtcblx0XHR0aGlzLnB0ID0gclsxXTtcblxuXHRcdHJldHVybiBbclswXSwgclsxXVsyXV07XG5cdH07XG5cblx0c3BsYXlfdHJlZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKCB2ICkge1xuXHRcdGlmICggdGhpcy5wdCAhPT0gbnVsbCApIHtcblx0XHRcdHRoaXMucHQgPSByZW1vdmUoIHRoaXMucHQsIHYgKTtcblx0XHR9XG5cdH07XG5cblx0c3BsYXlfdHJlZS5wcm90b3R5cGUuaW5fb3JkZXJfdHJhdmVyc2FsID0gZnVuY3Rpb24gKCBmbiApIHtcblx0XHRpZiAoIHRoaXMucHQgIT09IG51bGwgKSB7XG5cdFx0XHRpbl9vcmRlcl90cmF2ZXJzYWwoIHRoaXMucHQsIGZuICk7XG5cdFx0fVxuXHR9O1xuXG5cdHJldHVybiBzcGxheV90cmVlO1xuXG59XG5cbiJdfQ==